<!DOCTYPE html>
<html>
  <head>
    <title>Bunny Platformer</title>
    <script src="https://unpkg.com/aframe@1.4.2/dist/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system@4.0.1/dist/aframe-physics-system.min.js"></script>
    <style>
      .controls {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 10px;
        z-index: 999;
      }
      .btn {
        padding: 15px;
        background: rgba(255, 255, 255, 0.6);
        border-radius: 10px;
        font-weight: bold;
        user-select: none;
      }
    </style>
  </head>
  <body>
    <div class="controls">
      <div class="btn" onclick="moveLeft()">←</div>
      <div class="btn" onclick="jump()">↑</div>
      <div class="btn" onclick="moveRight()">→</div>
    </div>

    <a-scene physics="gravity: -9.8;" embedded>

      <!-- Ground -->
      <a-box position="0 0 -5" width="30" height="0.5" depth="30" color="#8BC34A" static-body></a-box>

      <!-- Parkour Platforms -->
      <a-box position="2 1 -3" width="2" height="0.5" depth="2" color="#FFC107" static-body></a-box>
      <a-box position="6 2 -3" width="2" height="0.5" depth="2" color="#FFC107" static-body></a-box>
      <a-box position="10 3 -3" width="2" height="0.5" depth="2" color="#FFC107" static-body></a-box>
      <a-box position="14 4 -3" width="2" height="0.5" depth="2" color="#FFC107" static-body></a-box>

      <!-- Movable Box -->
      <a-box position="5 5 -3" width="1" height="1" depth="1" color="#FF5722" dynamic-body></a-box>

      <!-- Player Bunny -->
      <a-entity id="player" position="0 2 -3" dynamic-body="mass: 1; shape: box;">
        <a-box id="bunny" width="1" height="1" depth="1" color="#FFF"></a-box>
        <!-- Optionally replace with a GLB model if available -->
        <!-- <a-gltf-model src="bunny.glb" scale="0.5 0.5 0.5"></a-gltf-model> -->
      </a-entity>

      <!-- Camera -->
      <a-entity 
        id="cameraRig"
        position="0 4 5"
        rotation="0 0 0"
        camera
        look-controls="enabled: false"
        wasd-controls="enabled: false">
      </a-entity>

      <!-- Lighting -->
      <a-entity light="type: directional; color: #FFF; intensity: 1" position="5 10 0"></a-entity>
      <a-sky color="#87CEEB"></a-sky>

    </a-scene>

    <script>
      const player = document.querySelector("#player");
      const cam = document.querySelector("#cameraRig");

      function moveLeft() {
        player.body.velocity.x = -3;
      }

      function moveRight() {
        player.body.velocity.x = 3;
      }

      function jump() {
        if (Math.abs(player.body.velocity.y) < 0.05) {
          player.body.velocity.y = 5;
        }
      }

      // Camera follow logic
      AFRAME.registerComponent("follow-player", {
        tick: function () {
          const playerPos = player.object3D.position;
          cam.setAttribute("position", {
            x: playerPos.x,
            y: playerPos.y + 3,
            z: playerPos.z + 6,
          });
        },
      });

      document.querySelector("a-scene").addEventListener("loaded", () => {
        cam.setAttribute("follow-player", "");
      });
    </script>
  </body>
</html>
